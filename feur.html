<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quoi?</title>

    <style>

        body, html {
            overflow: hidden;
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
        }

        h1 {
            will-change: transform;
        }

        #labelQuoi {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

    </style>

</head>

<body>
<label for="quoi" id="labelQuoi">
    Ã‰crit "quoi?" mon reuf
    <input type="text" id="quoi" placeholder="Quoi?">
</label>
</body>

<script type="application/javascript">
    const inputQuoi = document.getElementById('quoi');
    const labelQuoi = document.getElementById('labelQuoi');

    document.addEventListener("DOMContentLoaded", () => {
        inputQuoi.focus();

        inputQuoi.addEventListener("blur", () => {
            inputQuoi.focus();
        });

        inputQuoi.addEventListener('input', (e) => {
            if ("QUOI?" === e.target.value.trim().toUpperCase()) {
                ejfrgkjjnv();
            }
        });
    });

    function ecritureFeurAleatoire() {
        const tableauFeur = ['feur', 'feuR', 'feUr', 'feUR', 'fEur', 'fEuR', 'fEUr', 'fEUR', 'Feur', 'FeuR', 'FeUr', 'FeUR', 'FEur', 'FEuR', 'FEUr', 'FEUR', 'feur!', 'feuR!', 'feUr!', 'feUR!', 'fEur!', 'fEuR!', 'fEUr!', 'fEUR!', 'Feur!', 'FeuR!', 'FeUr!', 'FeUR!', 'FEur!', 'FEuR!', 'FEUr!', 'FEUR!',];
        return tableauFeur[Math.floor(Math.random() * tableauFeur.length)];
    }

    function couleurCSSAleatoire() {
        return `rgb(${Math.floor(Math.random() * 255)}, ${Math.floor(Math.random() * 255)}, ${Math.floor(Math.random() * 255)})`;
    }

    function yAleatoire() {
        const hauteurPage = window.innerHeight;
        return Math.floor(Math.random() * hauteurPage);
    }

    function xAleatoire() {
        const largeurPage = window.innerWidth;
        return Math.floor(Math.random() * largeurPage);
    }

    function rotationAleatoire() {
        return Math.floor(Math.random() * 90) - 45;
    }

    function majFeur(ceFeur) {
        ceFeur.style.left = xAleatoire() + "px";
        ceFeur.style.top = yAleatoire() + "px";
        ceFeur.innerHTML = ecritureFeurAleatoire();
        ceFeur.style.color = couleurCSSAleatoire();
        ceFeur.style.transform = `rotate(${rotationAleatoire()}deg)`;
        ceFeur.style.transform += " translateZ(0)";
    }

    function ejfrgkjjnv() {
        labelQuoi.remove();

        for (let i = 0; i < 1000; i++) {
            const tempsReactionInitial = Math.floor(Math.random() * 200);
            const tempsReactionFeur = Math.floor(Math.random() * 100) * 70 + 1000;
            const ceFeur = document.createElement('h1');
            ceFeur.style.position = "absolute";
            ceFeur.style.transition = "400ms ease-in-out";
            ceFeur.style.transitionProperty = "left, top, transform";
            majFeur(ceFeur);
            document.body.appendChild(ceFeur);

            setTimeoutWithRAF(() => {
                majFeur(ceFeur);
            }, tempsReactionInitial);

            setIntervalWithRAF(() => {
                majFeur(ceFeur);
            }, tempsReactionFeur);
        }

        document.title = ecritureFeurAleatoire();
        setInterval(() => {
            document.title = ecritureFeurAleatoire();
        }, 500);

    }

    function setIntervalWithRAF(callback, interval) {
        let lastTime = 0;

        function loop(time) {
            if (time - lastTime >= interval) {
                lastTime = time;
                callback();
            }
            requestAnimationFrame(loop);
        }

        requestAnimationFrame(loop);
    }

    function setTimeoutWithRAF(callback, timeout) {
        let lastTime = 0;

        function loop(time) {
            if (time - lastTime >= timeout) {
                lastTime = time;
                callback();
            } else {
                requestAnimationFrame(loop);
            }
        }

        requestAnimationFrame(loop);
    }


</script>

</html>
